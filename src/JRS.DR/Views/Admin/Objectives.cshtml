@model JRS.DR.ViewModels.Admin.ObjectivesListModel
@{
    ViewBag.Title = "Objectives";
}

<div class="col-sm-12">
    <div class="panel panel-default panel-table">
        <div class="panel-heading">
            <div class="row">
                <div class="col col-xs-6">
                    <h3 class="panel-title">Administrare obiective</h3>
                </div>
                <div class="col col-xs-6 text-right">
                    <a class="btn btn-block btn-primary" href="@Url.Action("Create", "Admin")">Creare Obiectiv</a>
                </div>
            </div>
        </div>
        <div class="panel-body">
            <table class="table table-striped table-bordered table-list">
                <thead>
                    <tr>
                        <th>Denumire</th>
                        <th>Descriere</th>
                        <th><em class="fa fa-cog"></em></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Objectives)
                    {
                        <tr>                            
                            <td>@item.Name</td>
                            <td>@item.Description</td>
                            <td align="center">
                                <a class="btn btn-default" href="@Url.Action("Edit", "Admin", new { objectiveId = item.ObjectiveId})">Edit</a>
                                <a class="btn btn-danger" onclick="openDeleteModal(@item.ObjectiveId);">Delete</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>

        </div>
        <div class="panel-footer">
            <div class="row">
                <div class="col col-xs-4">
                    Page 1 of 5
                </div>
                <div class="col col-xs-8">
                    <ul class="pagination hidden-xs pull-right">
                        <li><a href="#">1</a></li>
                        <li><a href="#">2</a></li>
                        <li><a href="#">3</a></li>
                        <li><a href="#">4</a></li>
                        <li><a href="#">5</a></li>
                    </ul>
                    <ul class="pagination visible-xs pull-right">
                        <li><a href="#">«</a></li>
                        <li><a href="#">»</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="confirmDeleteObjectiveModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                Confirmare stergere obiectiv
            </div>
            <div class="modal-body">
                Sunteti sigur ca vreti sa stergeti acest obiectiv?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Nu</button>
                <a class="btn btn-danger btn-ok" onclick="removeObjective();">Da</a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        var objectiveId = 0;
        function openDeleteModal(objId) {
            objectiveId = objId;
            $('#confirmDeleteObjectiveModal').modal('show');
        }

        function removeObjective() {
            $.ajax({
                url: "/Admin/Delete/" + objectiveId,
                type: "DELETE",
                contentType: "application/json",
                success: function (res) {
                    if (res.isError === true)
                    {
                        toastr.error(res.messages[0]);
                        return;
                    }
                    toastr.success("Obiectivul a fost sters!");
                    location.reload();
                },
                error: function () {
                    toastr.error("A aparut o eroare!");
                }
            });
        }
    </script>
}